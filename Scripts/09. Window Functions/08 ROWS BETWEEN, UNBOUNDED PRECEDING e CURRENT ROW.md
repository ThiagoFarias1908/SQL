# Script: ROWS BETWEEN, UNBOUNDED PRECEDING e CURRENT ROW

**Descrição:** ROWS BETWEEN: Define o intervalo de linhas sobre o qual a função de janela será aplicada. UNBOUNDED PRECEDING: Indica que o intervalo começa desde a primeira linha do particionamento, sem limites anteriores. CURRENT ROW: Indica que o intervalo inclui apenas a linha atual sendo processada pela função de janela.  

**Comando SQL:**
```SQL
WITH TOTAL_VENDAS(ANO, MÊS, VENDAS) AS
(
	SELECT
		DATEPART(YEAR, S.DateKey) AS ANO,
		DATEPART(MONTH, S.DateKey) AS MÊS,
		SUM(S.SalesAmount) AS VENDAS
	FROM FactOnlineSales AS S
	GROUP BY DATEPART(YEAR, S.DateKey), DATEPART(MONTH, S.DateKey)
)
SELECT
	ANO, MÊS, 
	FORMAT(VENDAS, 'C0') AS 'VENDAS',
	FORMAT( SUM(VENDAS) OVER(PARTITION BY ANO ORDER BY ANO, MÊS ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 'C0') AS VENDAS_YTD,
	FORMAT( AVG(VENDAS) OVER(PARTITION BY ANO ORDER BY ANO, MÊS ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 'C0') AS VENDAS_AVG,
	FORMAT( AVG(VENDAS) OVER(ORDER BY ANO, MÊS ASC ROWS BETWEEN 3 PRECEDING AND 1 PRECEDING), 'C0') AS VENDAS_AVG_3M,
	FORMAT( SUM(VENDAS) OVER(ORDER BY ANO, MÊS ASC ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING), 'C0') AS VENDAS_ÚLTIMO_MÊS
FROM TOTAL_VENDAS
ORDER BY ANO, MÊS
